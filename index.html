<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sport Planner</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Load React and ReactDOM (UMD for local file support) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Load Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.33.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.561.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <!-- Load modules in order -->
    <script type="text/babel" src="js/constants.js"></script>
    <script type="text/babel" src="js/utils.js"></script>
    <script type="text/babel" src="js/icons.js"></script>
    <script type="text/babel" src="js/components/selectors.js"></script>
    <script type="text/babel" src="js/components/modals.js"></script>
    <script type="text/babel" src="js/components/sessions.js"></script>
    <script type="text/babel" src="js/components/dayCard.js"></script>
    <script type="text/babel" src="js/components/inputScreens.js"></script>
    <script type="text/babel" src="js/components/monthlyView.js"></script>
    <script type="text/babel" src="js/app.js"></script>
    
    <!-- Main entry point -->
    <script type="text/babel">
        // Error overlay helpers (show runtime errors in page when JS throws)
        function showErrorOverlay(title, message) {
            try {
                let el = document.getElementById('__error_overlay');
                if (!el) {
                    el = document.createElement('div');
                    el.id = '__error_overlay';
                    el.style.position = 'fixed';
                    el.style.left = '12px';
                    el.style.right = '12px';
                    el.style.top = '12px';
                    el.style.zIndex = 99999;
                    el.style.background = 'rgba(255,255,255,0.98)';
                    el.style.color = '#1f2937';
                    el.style.border = '1px solid #ef4444';
                    el.style.padding = '12px';
                    el.style.borderRadius = '8px';
                    el.style.boxShadow = '0 6px 18px rgba(0,0,0,0.12)';
                    document.body.appendChild(el);
                }
                el.innerHTML = `<div style="font-weight:700;color:#b91c1c;margin-bottom:6px">${title}</div><div style="font-family:monospace;white-space:pre-wrap;font-size:12px">${message}</div>`;
            } catch (e) {
                console.error('Failed to show error overlay', e);
            }
        }

        window.onerror = function(message, source, lineno, colno, err) {
            console.error('Window error', message, err);
            showErrorOverlay('Runtime Error', `${message} \n${source}:${lineno}:${colno}\n${err && err.stack ? err.stack : ''}`);
        };
        window.addEventListener('unhandledrejection', (ev) => {
            console.error('Unhandled Rejection', ev.reason);
            showErrorOverlay('Unhandled Promise Rejection', `${ev.reason && ev.reason.stack ? ev.reason.stack : String(ev.reason)}`);
        });

        // Wait for all modules to load and then render
        const waitForModules = () => {
            if (window.SportPlanner && 
                window.SportPlanner.App && 
                window.SportPlanner.Constants && 
                window.SportPlanner.Utils &&
                window.SportPlanner.Icons &&
                window.SportPlanner.Selectors &&
                window.SportPlanner.Modals &&
                window.SportPlanner.Sessions &&
                window.SportPlanner.DayCard &&
                window.SportPlanner.InputScreens &&
                window.SportPlanner.MonthlyView) {
                
                const root = ReactDOM.createRoot(document.getElementById('root'));
                try { 
                    root.render(<window.SportPlanner.App />); 
                } catch (err) { 
                    console.error(err); 
                    showErrorOverlay('Render Error', err.stack || String(err)); 
                }
            } else {
                setTimeout(waitForModules, 50);
            }
        };
        
        waitForModules();
    </script>
</body>
</html>
